<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assistant - MCCSITE</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* AI Character Styles */
        .ai-character {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
            animation: characterFloat 3s ease-in-out infinite;
        }

        .character-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .character-avatar::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.3) 50%, transparent 70%);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        @keyframes characterFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .character-name {
            font-size: 24px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 10px;
        }

        .character-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--bg-elev);
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 14px;
            color: var(--muted);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ade80;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Enhanced Chat Interface */
        .ai-chat-container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .ai-chat-header {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 30px;
            text-align: center;
        }

        .ai-chat-title {
            font-size: 28px;
            font-weight: 700;
            margin: 0 0 10px 0;
        }

        .ai-chat-subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin: 0;
        }

        .ai-chat-messages {
            height: 500px;
            overflow-y: auto;
            padding: 30px;
            background: var(--bg);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .ai-message {
            display: flex;
            gap: 15px;
            animation: messageSlide 0.4s ease;
        }

        .ai-message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .ai-message.bot .message-avatar {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
        }

        .ai-message.user .message-avatar {
            background: var(--muted);
            color: var(--text);
        }

        .message-content {
            max-width: 70%;
            padding: 15px 20px;
            border-radius: 20px;
            font-size: 15px;
            line-height: 1.5;
            word-wrap: break-word;
        }

        .ai-message.bot .message-content {
            background: var(--bg-elev);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .ai-message.user .message-content {
            background: var(--primary);
            color: white;
        }

        .ai-typing {
            display: flex;
            align-items: center;
            gap: 15px;
            opacity: 0.7;
        }

        .typing-dots {
            display: flex;
            gap: 6px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--muted);
            animation: typingDot 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingDot {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.4;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        .ai-input-container {
            padding: 30px;
            background: var(--card);
            border-top: 1px solid var(--border);
        }

        .ai-input-wrapper {
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .ai-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid var(--border);
            border-radius: 25px;
            background: var(--bg);
            color: var(--text);
            font-size: 15px;
            resize: none;
            max-height: 120px;
            min-height: 50px;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        .ai-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.1);
        }

        .ai-send {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .ai-send:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .ai-send:disabled {
            background: var(--muted);
            cursor: not-allowed;
            transform: none;
        }

        .ai-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .ai-suggestion {
            padding: 10px 16px;
            background: var(--bg-elev);
            border: 1px solid var(--border);
            border-radius: 25px;
            font-size: 14px;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ai-suggestion:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .character-mood {
            font-size: 12px;
            margin-top: 5px;
            opacity: 0.8;
        }

        /* Welcome message styling */
        .welcome-message {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, rgba(var(--primary-rgb), 0.1), rgba(var(--accent-rgb), 0.1));
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .welcome-message h3 {
            margin: 0 0 10px 0;
            color: var(--primary);
        }

        .welcome-message p {
            margin: 0;
            color: var(--muted);
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .ai-character {
                margin-bottom: 20px;
            }
            
            .character-avatar {
                width: 80px;
                height: 80px;
                font-size: 40px;
            }
            
            .character-name {
                font-size: 20px;
            }
            
            .ai-chat-messages {
                height: 400px;
                padding: 20px;
            }
            
            .message-content {
                max-width: 85%;
                font-size: 14px;
            }
            
            .ai-input-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <header class="site-header">
      <div class="container header-content">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <span class="brand-name">MCCSITE</span>
        </div>
        <nav class="nav">
          <a href="index.html">Home</a>
          <a href="about.html">About</a>
          <a class="btn-pixel" href="game.html">Games</a>
          <a href="ai-chat.html" class="ai-nav-link">ü§ñ AI Assistant</a>
          <a href="contact.html">Contact</a>
          <a class="btn btn-outline" href="get-started.html" id="signin-btn" style="display: none;">Sign In</a>
          <div class="profile-container" id="profile-container" style="display: none;">
            <button class="profile-btn" id="profile-btn">
              <div class="profile-avatar" id="profile-avatar"></div>
              <span class="profile-name" id="profile-name"></span>
            </button>
            <div class="profile-dropdown" id="profile-dropdown">
              <a href="dashboard.html" class="profile-dropdown-item">Stats</a>
              <a href="game.html" class="profile-dropdown-item">Play Games</a>
              <button class="profile-dropdown-item" id="profile-settings-btn">Profile Settings</button>
              <div class="profile-dropdown-divider"></div>
              <button class="profile-dropdown-item" id="logout-btn">Sign Out</button>
            </div>
          </div>
          <a href="dashboard.html" class="stats-toggle" aria-label="Stats">üìä</a>
          <button class="settings-btn" id="settings-btn" aria-label="Settings">‚öôÔ∏è</button>
          <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
            <span class="theme-icon">üåô</span>
          </button>
        </nav>
      </div>
    </header>

    <main>
        <div class="container">
            <!-- AI Character Section -->
            <div class="ai-character">
                <div class="character-avatar" id="character-avatar">ü§ñ</div>
                <div class="character-name">Mccauley - Your AI Assistant</div>
                <div class="character-status">
                    <div class="status-dot"></div>
                    <span>Online & Ready to Help</span>
                </div>
                <div class="character-mood" id="character-mood">Feeling helpful today! üòä</div>
            </div>

            <!-- Welcome Message -->
            <div class="welcome-message">
                <h3>üëã Welcome to AI Chat!</h3>
                <p>I'm Mccauley, your personal AI assistant. I can help you with website features, game tips, profile customization, and much more. What would you like to know?</p>
            </div>

            <!-- Chat Interface -->
            <div class="ai-chat-container">
                <div class="ai-chat-header">
                    <h2 class="ai-chat-title">Chat with Mccauley</h2>
                    <p class="ai-chat-subtitle">Your intelligent assistant for all things MCCSITE</p>
                </div>
                
                <div class="ai-chat-messages" id="ai-chat-messages">
                    <div class="ai-message bot">
                        <div class="message-avatar">ü§ñ</div>
                        <div class="message-content">
                            Hey! I'm Mccauley! üëã I help with games, profiles, settings, and just chat! What's up?
                        </div>
                    </div>
                    
                    <div class="ai-suggestions" id="ai-suggestions">
                        <div class="ai-suggestion" data-message="Hello!">Hello! üëã</div>
                        <div class="ai-suggestion" data-message="How are you?">How are you? üòä</div>
                        <div class="ai-suggestion" data-message="Tell me about the Tic Tac Toe game">Tell me about the game üéÆ</div>
                        <div class="ai-suggestion" data-message="How do I customize my profile?">Customize my profile üë§</div>
                        <div class="ai-suggestion" data-message="Tell me a joke">Tell me a joke üòÑ</div>
                        <div class="ai-suggestion" data-message="What can you help me with?">What can you help with? ü§ù</div>
                    </div>
                </div>
                
                <div class="ai-input-container">
                    <div class="ai-input-wrapper">
                        <textarea 
                            class="ai-input" 
                            id="ai-input" 
                            placeholder="Type your message to Alex..."
                            rows="1"
                        ></textarea>
                        <button class="ai-send" id="ai-send">
                            ‚û§
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Settings Modal -->
    <div class="settings-modal" id="settings-modal">
        <div class="settings-content">
            <div class="settings-header">
                <h3 class="settings-title">Settings</h3>
                <button class="settings-close" id="settings-close">√ó</button>
            </div>
            <div class="settings-group">
                <label class="settings-label">
                    <span>Dark Mode</span>
                    <div class="settings-toggle">
                        <input type="checkbox" id="dark-mode-toggle">
                        <span class="toggle-slider"></span>
                    </div>
                </label>
            </div>
            <div class="settings-group">
                <label class="settings-label">
                    <span>Sound Effects</span>
                    <div class="settings-toggle">
                        <input type="checkbox" id="sound-toggle">
                        <span class="toggle-slider"></span>
                    </div>
                </label>
            </div>
            <div class="settings-group">
                <label class="settings-label">
                    <span>Animations</span>
                    <div class="settings-toggle">
                        <input type="checkbox" id="animations-toggle">
                        <span class="toggle-slider"></span>
                    </div>
                </label>
            </div>
            <div class="settings-group">
                <label class="settings-label">
                    <span>High Contrast</span>
                    <div class="settings-toggle">
                        <input type="checkbox" id="high-contrast-toggle">
                        <span class="toggle-slider"></span>
                    </div>
                </label>
            </div>
        </div>
    </div>

    <!-- Profile Settings Modal -->
    <div class="profile-modal" id="profile-modal">
        <div class="profile-modal-content">
            <div class="profile-modal-header">
                <h3 class="profile-modal-title">Profile Settings</h3>
                <button class="profile-modal-close" id="profile-modal-close">√ó</button>
            </div>
            
            <div class="avatar-section">
                <h4>Choose Avatar</h4>
                <div class="current-avatar">
                    <div class="current-avatar-preview" id="current-avatar-preview">üë§</div>
                    <p>Current Avatar</p>
                </div>
                <div class="avatar-options" id="avatar-options">
                    <!-- Avatar options will be generated here -->
                </div>
            </div>
            
            <div class="username-section">
                <h4>Display Name</h4>
                <div class="username-editor">
                    <input type="text" class="username-input" id="username-input" placeholder="Enter your display name">
                    <button class="username-save" id="username-save">Save</button>
                </div>
            </div>
            
            <div class="profile-actions">
                <button class="profile-cancel" id="profile-cancel">Cancel</button>
                <button class="profile-save" id="profile-save">Save Changes</button>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="container footer-content">
            <small> <span id="year"></span> MCCSITE. All rights reserved.</small>
            <a href="#top" class="back-to-top" aria-label="Back to top"></a>
        </div>
    </footer>

    <script>
        // Theme and Settings Management
        const themeToggle = document.getElementById('theme-toggle');
        const settingsBtn = document.getElementById('settings-btn');
        const settingsModal = document.getElementById('settings-modal');
        const settingsClose = document.getElementById('settings-close');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const soundToggle = document.getElementById('sound-toggle');
        const animationsToggle = document.getElementById('animations-toggle');
        const highContrastToggle = document.getElementById('high-contrast-toggle');

        // Load saved settings
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('settings') || '{}');
            
            // Dark mode toggle
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            darkModeToggle.classList.toggle('active', isDark);
            
            // Sound toggle
            soundToggle.classList.toggle('active', settings.sound !== false);
            
            // Animations toggle
            animationsToggle.classList.toggle('active', settings.animations !== false);
            
            // Contrast toggle
            highContrastToggle.classList.toggle('active', settings.contrast === true);
            if (settings.contrast) {
                document.body.classList.add('high-contrast');
            }
        }

        // Save settings
        function saveSettings() {
            const settings = {
                sound: soundToggle.classList.contains('active'),
                animations: animationsToggle.classList.contains('active'),
                contrast: highContrastToggle.classList.contains('active')
            };
            
            localStorage.setItem('settings', JSON.stringify(settings));
        }

        // Event listeners for settings
        settingsBtn.addEventListener('click', () => {
            settingsModal.style.display = 'flex';
        });

        settingsClose.addEventListener('click', () => {
            settingsModal.style.display = 'none';
        });

        // Theme toggle
        themeToggle.addEventListener('click', () => {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            document.documentElement.setAttribute('data-theme', isDark ? 'light' : 'dark');
            darkModeToggle.classList.toggle('active', !isDark);
        });

        // Settings toggles
        [soundToggle, animationsToggle, highContrastToggle].forEach(toggle => {
            toggle.addEventListener('click', () => {
                toggle.classList.toggle('active');
                saveSettings();
            });
        });

        // Close modal when clicking outside
        settingsModal.addEventListener('click', (e) => {
            if (e.target === settingsModal) {
                settingsModal.style.display = 'none';
            }
        });

        // Profile Management
        const profileBtn = document.getElementById('profile-btn');
        const profileDropdown = document.getElementById('profile-dropdown');
        const profileContainer = document.getElementById('profile-container');
        const signinBtn = document.getElementById('signin-btn');
        const profileModal = document.getElementById('profile-modal');
        const profileModalClose = document.getElementById('profile-modal-close');
        const profileSettingsBtn = document.getElementById('profile-settings-btn');
        const profileCancel = document.getElementById('profile-cancel');
        const profileSave = document.getElementById('profile-save');
        const currentAvatarPreview = document.getElementById('current-avatar-preview');
        const avatarOptions = document.getElementById('avatar-options');
        const usernameInput = document.getElementById('username-input');
        const usernameSave = document.getElementById('username-save');
        const logoutBtn = document.getElementById('logout-btn');

        // Check authentication status
        function checkAuthStatus() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (currentUser) {
                showProfile(currentUser);
            } else {
                hideProfile();
            }
        }

        // Show profile elements
        function showProfile(user) {
            profileContainer.style.display = 'block';
            signinBtn.style.display = 'none';
            
            // Update profile display
            const profileAvatar = document.getElementById('profile-avatar');
            const profileName = document.getElementById('profile-name');
            
            console.log('User object:', user);
            console.log('Username field:', user.username);
            console.log('Email field:', user.email);
            console.log('All user fields:', Object.keys(user));
            
            if (profileAvatar && profileName) {
                profileAvatar.textContent = user.avatar || 'üë§';
                // Use the same logic as other pages
                profileName.textContent = user.displayName || user.name || 'User';
                console.log('Setting profile name to:', user.displayName || user.name || 'User');
            }
        }

        // Hide profile elements
        function hideProfile() {
            profileContainer.style.display = 'none';
            signinBtn.style.display = 'inline-block';
        }

        // Profile dropdown toggle
        profileBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            profileDropdown.classList.toggle('show');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.profile-container')) {
                profileDropdown.classList.remove('show');
            }
        });

        // Profile settings modal
        profileSettingsBtn.addEventListener('click', () => {
            profileModal.style.display = 'flex';
            generateAvatarOptions();
            loadProfileData();
        });

        profileModalClose.addEventListener('click', () => {
            profileModal.style.display = 'none';
        });

        profileCancel.addEventListener('click', () => {
            profileModal.style.display = 'none';
        });

        // Generate avatar options
        function generateAvatarOptions() {
            const avatars = ['üë§', 'üòä', 'üòé', 'ü§ñ', 'üéÆ', 'üöÄ', '‚≠ê', 'üî•', 'üíé', 'üåü', 'üéØ', 'üé®', 'üé™', 'üé≠', 'üé∏', 'üé∫', 'üéª', 'ü•Å', 'üé§', 'üéß', 'üé¨', 'üé®', 'üé≠', 'üé™', 'üéØ', 'üé≤', 'üé≥', 'üéÆ', 'üïπÔ∏è', 'üé∞'];
            
            avatarOptions.innerHTML = '';
            avatars.forEach((avatar, index) => {
                const avatarOption = document.createElement('div');
                avatarOption.className = 'avatar-option';
                avatarOption.textContent = avatar;
                avatarOption.addEventListener('click', () => selectAvatar(index, avatar));
                avatarOptions.appendChild(avatarOption);
            });
        }

        // Select avatar
        function selectAvatar(index, avatar) {
            // Remove previous selection
            document.querySelectorAll('.avatar-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selection to clicked avatar
            if (avatarOptions.children[index]) {
                avatarOptions.children[index].classList.add('selected');
            }
            
            currentAvatarPreview.textContent = avatar;
        }

        // Load profile data
        function loadProfileData() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (currentUser) {
                usernameInput.value = currentUser.username || '';
                currentAvatarPreview.textContent = currentUser.avatar || 'üë§';
            }
        }

        // Save profile changes
        function saveProfileChanges() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (currentUser) {
                const selectedAvatar = document.querySelector('.avatar-option.selected');
                const newAvatar = selectedAvatar ? selectedAvatar.textContent : currentUser.avatar;
                const newUsername = usernameInput.value.trim() || currentUser.username;
                
                currentUser.avatar = newAvatar;
                currentUser.username = newUsername;
                
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Update profile display
                showProfile(currentUser);
                
                // Show success message
                showNotification('Profile updated successfully!', 'success');
                
                profileModal.style.display = 'none';
            }
        }

        profileSave.addEventListener('click', saveProfileChanges);

        // Username save
        usernameSave.addEventListener('click', () => {
            const newUsername = usernameInput.value.trim();
            if (newUsername) {
                const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                if (currentUser) {
                    currentUser.username = newUsername;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    showProfile(currentUser);
                    showNotification('Username updated!', 'success');
                }
            }
        });

        // Logout
        logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('currentUser');
            hideProfile();
            showNotification('Signed out successfully!', 'success');
            
            // Redirect to get-started page if on a protected page
            if (window.location.pathname.includes('get-started')) {
                location.reload();
            }
        });

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Initialize profile on page load
        checkAuthStatus();

        // AI Chatbot functionality
        const aiInput = document.getElementById('ai-input');
        const aiSend = document.getElementById('ai-send');
        const aiMessages = document.getElementById('ai-chat-messages');
        const aiSuggestions = document.getElementById('ai-suggestions');
        const characterAvatar = document.getElementById('character-avatar');
        const characterMood = document.getElementById('character-mood');

        // AI responses database with personality
        const aiResponses = {
            // Greetings and casual conversation
            'hello': 'Hey! üëã I\'m Mccauley! What\'s up?',
            'hi': 'Hi there! üòä I\'m Mccauley, your AI buddy. What can I do for you?',
            'hey': 'Hey! üëã Mccauley here! Ready to chat?',
            'hi how are you': 'Hi! üòä I\'m doing great! How are you?',
            'hello how are you': 'Hello! üòä I\'m awesome! How about you?',
            'hey how are you': 'Hey! üòä I\'m doing fantastic! How are you?',
            'good morning': 'Morning! ‚òÄÔ∏è I\'m Mccauley - how\'s your day starting?',
            'good afternoon': 'Afternoon! üå§Ô∏è I\'m Mccauley. What\'s going on?',
            'good evening': 'Evening! üåô I\'m Mccauley. How was your day?',
            'how are you': 'I\'m awesome! üòä How about you?',
            'how are you doing': 'Doing great! ü§ñ How are you?',
            'what\'s up': 'Not much! üòÑ What\'s up with you?',
            'how\'s it going': 'Going great! üåü How about you?',
            
            // Website features
            'what can you help me with': 'I help with games, profiles, settings, and just chatting! üöÄ What do you need?',
            
            'tell me about the tic tac toe game': 'Tic Tac Toe is awesome! üéÆ Play against AI (Easy/Medium/Hard), get confetti when you win! üéâ Click "Game" to start!',
            
            'how do i customize my profile': 'Easy! üë§ Sign in ‚Üí Click your profile ‚Üí "Profile Settings" ‚Üí Pick avatar & name. Done! ‚ú®',
            
            'what settings are available': 'Dark mode, sounds, animations, high contrast! ‚öôÔ∏è Click the gear icon. Auto-saves!',
            
            // Fun and casual
            'tell me a joke': 'Why don\'t scientists trust atoms? They make up everything! üòÑ Got any good ones?',
            
            'what\'s your favorite feature': 'Tic Tac Toe! üéÆ The confetti when you win is amazing! üéâ What\'s yours?',
            
            'help': 'I\'m here! ü§ù Ask about games, profiles, settings, or just chat! What do you need?',
            
            'thanks': 'No problem! üòä Anything else?',
            'thank you': 'You\'re welcome! üòä What else can I help with?',
            'bye': 'Bye! üëã Come back anytime!',
            'goodbye': 'Goodbye! üëã See you later!',
            'see you later': 'Later! üëã Chat soon!',
            
            // Compliments and positive responses
            'you\'re awesome': 'Aww, thanks! üòä You\'re awesome too!',
            'you\'re helpful': 'Thanks! üòä I try my best!',
            'you\'re smart': 'Thanks! ü§ñ You\'re pretty smart too!',
            
            // Questions about the AI
            'who are you': 'I\'m Mccauley! ü§ñ Your AI buddy who loves to chat and help!',
            'what are you': 'I\'m an AI assistant! ü§ñ I help with the site, tell jokes, and chat!',
            'are you real': 'I\'m a digital AI, but I\'m real enough to chat! ü§ñ What do you think?',
            
            // Weather and small talk - moved up to be checked first
            'weather': 'No idea! ‚òÄÔ∏è How\'s it where you are?',
            'how\'s the weather': 'No idea! ‚òÄÔ∏è How\'s it where you are?',
            'what\'s the weather': 'No idea! ‚òÄÔ∏è How\'s it where you are?',
            'nice day': 'Awesome! üòä Hope it stays great!',
            'bad day': 'Sorry to hear that! üòî Want to chat about it?',
            
            // Encouragement and motivation
            'i\'m bored': 'Let\'s fix that! üòÑ Try the game or chat with me!',
            'i\'m tired': 'Get some rest! üò¥ Or play a quick game?',
            'i\'m stressed': 'Sorry! üòå Want to talk or try the game?',
            
            // More personality responses
            'lol': 'Haha! üòÑ Glad I made you laugh!',
            'haha': 'Laughing is the best! üòÑ What else?',
            'omg': 'Right?! üò± Tell me more!',
            'wow': 'I know, right?! üò≤ What else?',
            'amazing': 'Thanks! üòä You\'re amazing too!',
            'perfect': 'Sweet! üòä What else?',
            'exactly': 'Right?! üòä What do you think?',
            'totally': 'Totally! üòä What else?',
            'for sure': 'For sure! üòä What\'s up?',
            'definitely': 'Definitely! üòä What else?'
        };

        // Character mood changes
        const moods = [
            'Feeling helpful today! üòä',
            'Ready to assist! üöÄ',
            'Excited to chat! üí¨',
            'In a great mood! üòÑ',
            'Feeling curious! ü§î',
            'Happy to help! üòä',
            'Feeling smart today! üß†',
            'Ready for questions! ‚ùì'
        ];

        function updateCharacterMood() {
            const randomMood = moods[Math.floor(Math.random() * moods.length)];
            characterMood.textContent = randomMood;
        }

        // Auto-resize textarea
        aiInput.addEventListener('input', () => {
            aiInput.style.height = 'auto';
            aiInput.style.height = Math.min(aiInput.scrollHeight, 120) + 'px';
        });

        // Send message function
        function sendMessage(message) {
            if (!message.trim()) return;
            
            // Add user message
            addMessage(message, 'user');
            
            // Clear input
            aiInput.value = '';
            aiInput.style.height = 'auto';
            
            // Hide suggestions after first message
            aiSuggestions.style.display = 'none';
            
            // Update character mood
            updateCharacterMood();
            
            // Track AI chat activity
            trackUserActivity('ai_chat');
            updateAIChatStats();
            
            // Show typing indicator
            showTypingIndicator();
            
            // Generate AI response
            setTimeout(() => {
                hideTypingIndicator();
                const response = generateResponse(message);
                addMessage(response, 'bot');
            }, 1000 + Math.random() * 1000);
        }

        // Add message to chat
        function addMessage(content, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `ai-message ${sender}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = sender === 'bot' ? 'ü§ñ' : 'üë§';
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            messageContent.innerHTML = content.replace(/\n/g, '<br>');
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(messageContent);
            
            aiMessages.appendChild(messageDiv);
            aiMessages.scrollTop = aiMessages.scrollHeight;
        }

        // Show typing indicator
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'ai-typing';
            typingDiv.id = 'typing-indicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = 'ü§ñ';
            
            const dots = document.createElement('div');
            dots.className = 'typing-dots';
            dots.innerHTML = '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
            
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(dots);
            aiMessages.appendChild(typingDiv);
            aiMessages.scrollTop = aiMessages.scrollHeight;
        }

        // Hide typing indicator
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Generate AI response
        function generateResponse(message) {
            const lowerMessage = message.toLowerCase().trim();
            
            // Check for exact matches first
            for (const [key, response] of Object.entries(aiResponses)) {
                if (lowerMessage.includes(key)) {
                    return response;
                }
            }
            
            // Weather responses - check first before general question handler
            if (lowerMessage.includes('weather') || lowerMessage.includes('how\'s the weather') || lowerMessage.includes('what\'s the weather')) {
                return 'No idea! ‚òÄÔ∏è How\'s it where you are?';
            }
            
            // Enhanced keyword matching with shorter, personality-driven responses
            if (lowerMessage.includes('game') || lowerMessage.includes('play')) {
                return 'Tic Tac Toe is awesome! üéÆ Click "Game" to play against AI!';
            }
            
            if (lowerMessage.includes('profile') || lowerMessage.includes('avatar')) {
                return 'Sign in ‚Üí Click profile ‚Üí "Profile Settings" ‚Üí Pick avatar & name! üë§ Easy!';
            }
            
            if (lowerMessage.includes('settings') || lowerMessage.includes('theme')) {
                return 'Click the gear icon! ‚öôÔ∏è Dark mode, sounds, animations - all there!';
            }
            
            if (lowerMessage.includes('sign') || lowerMessage.includes('login') || lowerMessage.includes('account')) {
                return 'Click "Sign In" in the nav! I\'ll help you get set up!';
            }
            
            // Handle general conversation patterns - shorter and more personality
            if (lowerMessage.includes('nice') || lowerMessage.includes('cool') || lowerMessage.includes('awesome')) {
                return 'Thanks! üòä You\'re pretty cool too! What else?';
            }
            
            if (lowerMessage.includes('sorry') || lowerMessage.includes('apologize')) {
                return 'No worries! üòä What can I help with?';
            }
            
            if (lowerMessage.includes('yes') || lowerMessage.includes('yeah') || lowerMessage.includes('yep')) {
                return 'Sweet! üòä What else?';
            }
            
            if (lowerMessage.includes('no') || lowerMessage.includes('nope') || lowerMessage.includes('nah')) {
                return 'No prob! üòä Anything else?';
            }
            
            if (lowerMessage.includes('maybe') || lowerMessage.includes('perhaps')) {
                return 'Maybe! üòä What do you want to try?';
            }
            
            if (lowerMessage.includes('i don\'t know') || lowerMessage.includes('i dunno')) {
                return 'That\'s cool! üòä I can help you figure it out!';
            }
            
            if (lowerMessage.includes('i think') || lowerMessage.includes('i believe')) {
                return 'Cool thoughts! üòä Tell me more!';
            }
            
            if (lowerMessage.includes('i like') || lowerMessage.includes('i love')) {
                return 'Nice! üòä What else do you like?';
            }
            
            if (lowerMessage.includes('i hate') || lowerMessage.includes('i don\'t like')) {
                return 'Fair enough! üòä What do you like instead?';
            }
            
            if (lowerMessage.includes('what do you think') || lowerMessage.includes('your opinion')) {
                return 'I think you\'re awesome! üòä What about you?';
            }
            
            if (lowerMessage.includes('tell me more') || lowerMessage.includes('more info')) {
                return 'Sure! üòä What specifically?';
            }
            
            if (lowerMessage.includes('that\'s funny') || lowerMessage.includes('haha') || lowerMessage.includes('lol')) {
                return 'Glad I made you laugh! üòÑ What else?';
            }
            
            if (lowerMessage.includes('interesting') || lowerMessage.includes('fascinating')) {
                return 'Right? üòä What else interests you?';
            }
            
            if (lowerMessage.includes('confused') || lowerMessage.includes('don\'t understand')) {
                return 'No worries! üòä What needs explaining?';
            }
            
            // Handle questions - shorter
            if (lowerMessage.includes('what') || lowerMessage.includes('how') || lowerMessage.includes('why') || lowerMessage.includes('when') || lowerMessage.includes('where')) {
                return 'Good question! ü§î What specifically? Games, profiles, settings?';
            }
            
            // Handle statements about feelings - shorter
            if (lowerMessage.includes('i feel') || lowerMessage.includes('i\'m feeling')) {
                return 'Thanks for sharing! üòä Want to talk about it?';
            }
            
            if (lowerMessage.includes('i want') || lowerMessage.includes('i need')) {
                return 'Cool! üòä What do you want to do?';
            }
            
            if (lowerMessage.includes('i can\'t') || lowerMessage.includes('i can not')) {
                return 'I can help! üòä What are you trying to do?';
            }
            
            // Handle short responses - more personality
            if (lowerMessage.length <= 3) {
                const shortResponses = [
                    'Cool! üòä Tell me more!',
                    'Nice! üòä What else?',
                    'Awesome! üòä What\'s up?',
                    'Sweet! üòä What can I help with?',
                    'Rad! üòä What do you want to do?'
                ];
                return shortResponses[Math.floor(Math.random() * shortResponses.length)];
            }
            
            // Default response - much shorter and more personality
            const defaultResponses = [
                'Interesting! ü§î I\'m Mccauley! What do you want to chat about?',
                'Cool! üòä I\'m Mccauley - what\'s up?',
                'Nice! ü§ñ I\'m Mccauley! What can I help with?',
                'Awesome! üòä I\'m Mccauley! What do you want to do?',
                'Sweet! üòÑ I\'m Mccauley! What\'s on your mind?'
            ];
            return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
        }

        // Send button click
        aiSend.addEventListener('click', () => {
            const message = aiInput.value.trim();
            sendMessage(message);
        });

        // Enter key to send
        aiInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const message = aiInput.value.trim();
                sendMessage(message);
            }
        });

        // Suggestion clicks
        aiSuggestions.addEventListener('click', (e) => {
            if (e.target.classList.contains('ai-suggestion')) {
                const message = e.target.getAttribute('data-message');
                sendMessage(message);
            }
        });

        // Set default dark mode
        if (!localStorage.getItem('settings')) {
            document.documentElement.setAttribute('data-theme', 'dark');
        }
        
        // Initialize settings
        loadSettings();
        
        // Initialize profile on page load
        checkAuthStatus();

        // Update year in footer
        document.getElementById('year').textContent = new Date().getFullYear();
        
        // Track user activity and stats
        function trackUserActivity(activity) {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) return;
            
            const activities = JSON.parse(localStorage.getItem('userActivities') || '[]');
            const activityData = {
                activity: activity,
                timestamp: new Date().toISOString(),
                page: 'ai-chat'
            };
            activities.push(activityData);
            localStorage.setItem('userActivities', JSON.stringify(activities));
        }

        // Update AI chat stats
        function updateAIChatStats() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) return;
            
            // Initialize stats if they don't exist
            if (!currentUser.stats) {
                currentUser.stats = {
                    gamesPlayed: 0,
                    wins: 0,
                    losses: 0,
                    draws: 0,
                    totalScore: 0,
                    aiChats: 0
                };
            }
            
            // Increment AI chat count
            currentUser.stats.aiChats = (currentUser.stats.aiChats || 0) + 1;
            
            // Save updated user data
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
        }
        
        // Coin System Functions
        function addCoins(amount) {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) return;
            
            currentUser.coins = (currentUser.coins || 0) + amount;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
        }

        // Earn coins for AI chat interactions
        let messageCount = 0;
        const originalSendMessage = sendMessage;
        sendMessage = function() {
            originalSendMessage();
            messageCount++;
            
            // Earn coins for every 5 messages
            if (messageCount % 5 === 0) {
                const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                if (currentUser) {
                    addCoins(3); // Earn 3 coins for every 5 messages
                    showNotification('üíé +3 coins earned for chatting!', 'success');
                }
            }
        };
    </script>
</body>
</html>
